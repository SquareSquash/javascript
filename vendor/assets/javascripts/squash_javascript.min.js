(function(){var g,f={}.hasOwnProperty,i=[].slice,e="undefined"!==typeof exports&&null!==exports?exports:this,k=function(){},r;r=void 0;k.instance=function(){return null!=r?r:r=new g};e.SquashJavascript=k;var e=function(){TraceKit.report.subscribe(function(c,b){return SquashJavascript.instance().report(c,b)})},n,m,v,A;e.prototype.configure=function(c){var b,d,a;this.options||(this.options={disabled:!1,notifyPath:"/api/1.0/notify",transmitTimeout:15E3,ignoredExceptionClasses:[],ignoredExceptionMessages:{}});
a=[];for(b in c)f.call(c,b)&&(d=c[b],a.push(this.options[b]=d));return a};e.prototype.notify=function(c,b){if(c instanceof Error)return c._squash_user_data=b,TraceKit.report(c);throw c;};e.prototype.report=function(c,b){var d,a,j,x,F,G,p,h,e,k,i,m;try{if(null!=(G=this.options)&&G.disabled)return!1;if(!(null!=(p=this.options)&&p.APIKey)||!(null!=(h=this.options)&&h.environment)||!(null!=(e=this.options)&&e.revision)||!(null!=(k=this.options)&&k.APIHost))return console.error("Missing required Squash configuration keys"),
!1;if(this.shouldIgnoreError(c)||!c.stack)return!1;a={};a.api_key=this.options.APIKey;a.environment=this.options.environment;a.client="javascript";a.revision=this.options.revision;a.class_name=null!=(i=c.type)?i:c.name;!c.name&&(x=c.message.match(/^(Uncaught )?(\w+): (.+)/))?(a.class_name=x[2],a.message=x[3]):a.message=c.message;null==a.class_name&&(a.class_name="Error");a.backtraces=v(c.stack);a.capture_method=c.mode;a.occurred_at=n(new Date);a.schema=window.location.protocol.replace(/:$/,"");a.host=
window.location.hostname;0<window.location.port.length&&(a.port=window.location.port);a.path=window.location.pathname;a.query=window.location.search;""!==window.location.hash&&(a.fragment=window.location.hash);a.user_agent=navigator.userAgent;a.screen_width=screen.width;a.screen_height=screen.height;a.window_width=window.innerWidth;a.window_height=window.innerHeight;a.color_depth=screen.colorDepth;if(b)for(j in m=b._squash_user_data,m)f.call(m,j)&&(F=m[j],a[j]=F);d=JSON.stringify(a);this.HTTPTransmit(this.options.APIHost+
this.options.notifyPath,[["Content-Type","application/json"]],d);return!0}catch(g){return console.error("Error while trying to notify Squash:",g.stack),console.error("-- original error:",c)}};e.prototype.addUserData=function(c,b){try{return b()}catch(d){throw null==d._squash_user_data&&(d._squash_user_data={}),A(d._squash_user_data,c),d;}};e.prototype.addingUserData=function(c,b){return function(){var d;d=1<=arguments.length?i.call(arguments,0):[];return SquashJavascript.instance().addUserData(c,
function(){return b.apply(null,d)})}};e.prototype.ignoreExceptions=function(){var c,b;b=2<=arguments.length?i.call(arguments,0,c=arguments.length-1):(c=0,[]);c=arguments[c++];try{return c()}catch(d){throw d._squash_ignored_exceptions=(d._squash_ignored_exceptions||[]).concat(b),d;}};e.prototype.ignoringExceptions=function(){var c,b,d;b=2<=arguments.length?i.call(arguments,0,d=arguments.length-1):(d=0,[]);c=arguments[d++];return function(){var a,j;a=1<=arguments.length?i.call(arguments,0):[];return(j=
SquashJavascript.instance()).ignoreExceptions.apply(j,i.call(b).concat([function(){return c.apply(null,a)}]))}};e.prototype.HTTPTransmit=function(c,b,d){var a,j,x;a=new XMLHttpRequest;a.open("POST",c,!0);a.timeout=this.options.transmitTimeout;j=0;for(x=b.length;j<x;j++)c=b[j],a.setRequestHeader(c[0],c[1]);a.send(d);return a};e.prototype.shouldIgnoreError=function(c){var b;b=this.options.ignoredExceptionClasses.concat(c._squash_ignored_exceptions||[]);return m(b,function(b){return c.name===b})?!0:
m(this.options.ignoredExceptionMessages,function(b,a){return c.name===b?m(a,function(a){return c.message.match(a)}):!1})};v=function(c){var b,d,a,j,x;b=[];j=0;for(x=c.length;j<x;j++)a=c[j],(d=a.context)&&m(d,function(a){return a&&200<a.length})&&(d=null),b.push({url:a.url,line:a.line,column:a.column,symbol:a.func,context:d,type:"js:hosted"});return[{name:"Active Thread",faulted:!0,backtrace:b}]};n=function(c){var b;b=function(c){return 10>c?"0"+c:c};return""+c.getUTCFullYear()+"-"+b(c.getUTCMonth()+
1)+"-"+b(c.getUTCDate())+"T"+b(c.getUTCHours())+":"+b(c.getUTCMinutes())+":"+b(c.getUTCSeconds())+"Z"};m=function(c,b){var d,a,j;if(c instanceof Array){a=0;for(j=c.length;a<j;a++)if(d=c[a],b(d))return!0}else for(d in c)if(f.call(c,d)&&(a=c[d],b(d,a)))return!0;return!1};A=function(c,b){var d,a,j;j=[];for(d in b)f.call(b,d)&&(a=b[d],j.push(c[d]=a));return j};g=e}).call(this);var TraceKit={};
TraceKit.report=function(){function g(e,k){var g=null,f;for(f in i)if(i.hasOwnProperty(f))try{i[f](e,k)}catch(c){g=c}if(g)throw g;}function f(n){if(k){if(e===n)return;var i=k;e=k=null;g(i,n)}var f=TraceKit.computeStackTrace(n);k=f;e=n;window.setTimeout(function(){e===n&&(e=k=null,g(f,n))},f.incomplete?2E3:0);throw n;}var i=[],e=null,k=null,r=window.onerror;window.onerror=function(n,f,i,A,c){var b=null,d=null;c&&(b=TraceKit.computeStackTrace(c));b||(k?(TraceKit.computeStackTrace.augmentStackTraceWithInitialElement(k,f,
i,A,n),b=k,d=e,e=k=null):(b={url:f,line:i,column:A},b.func=TraceKit.computeStackTrace.guessFunctionName(b.url,b.line),b.context=TraceKit.computeStackTrace.gatherContext(b.url,b.line),b={mode:"onerror",message:n,stack:[b]}));g(b,d);return r?r.apply(this,arguments):!1};f.subscribe=function(e){i.push(e)};f.unsubscribe=function(e){for(var f=i.length-1;0<=f;--f)i[f]===e&&i.splice(f,1)};return f}();
TraceKit.computeStackTrace=function(){function g(a){if(!d.hasOwnProperty(a)){var j,c=a.split("/");if(2<c.length&&c[2]===document.domain)try{void 0===XMLHttpRequest&&(XMLHttpRequest=function(){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(a){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(j){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(c){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(b){}throw Error("No XHR.");});var b=new XMLHttpRequest;b.open("GET",a,!1);
b.send("");j=b.responseText}catch(e){j=""}else j=[];d[a]=j.length?j.split("\n"):[]}return d[a]}function f(a,j){var c=/function ([^(]*)\(([^)]*)\)/,b=/['"]?([0-9A-Za-z$_]+)['"]?\s*[:=]\s*(function|eval|new Function)/,d="",e=g(a),h;if(!e.length)return"?";for(var f=0;10>f;++f)if(d=e[j-f]+d,void 0!==d&&((h=b.exec(d))||(h=c.exec(d))))return h[1];return"?"}function i(a,c){var b=g(a),d=[],e=!1;if(!b.length)return null;for(var c=c-1,f=c-2,h=c+2;f<h;++f)d.push(b[f]),void 0!==b[f]&&(e=!0);return e?d:null}function e(a){return a.replace(/[\-\[\]{}()*+?.,\\\^$|#]/g,
"\\$&")}function k(a){return e(a).replace("<","(?:<|&lt;)").replace(">","(?:>|&gt;)").replace("&","(?:&|&amp;)").replace('"','(?:"|&quot;)').replace(/\s+/g,"\\s+")}function r(a,c){for(var b,d,f=0,e=c.length;f<e;++f)if((b=g(c[f])).length)if(b=b.join("\n"),d=a.exec(b))return{url:c[f],line:b.substring(0,d.index).split("\n").length,column:d.index-b.lastIndexOf("\n",d.index)-1};return null}function n(a,c,b){var c=g(c),a=RegExp("\\b"+e(a)+"\\b"),d,b=b-1;return c&&c.length>b&&(d=a.exec(c[b]))?d.index:null}
function m(a){var c=[window.location.href],b=document.getElementsByTagName("script"),a=""+a,d;for(d=0;d<b.length;++d){var f=b[d];f.src&&c.push(f.src)}(b=/^function(?:\s+([\w$]+))?\s*\(([\w\s,]*)\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/.exec(a))?(d=b[1]?"\\s+"+b[1]:"",f=b[2].split(",").join("\\s*,\\s*"),b=e(b[3]).replace(/;$/,";?").replace(/\s+/g,"\\s+"),d=RegExp("function"+d+"\\s*\\(\\s*"+f+"\\s*\\)\\s*{\\s*"+b+"\\s*}")):d=RegExp(e(a).replace(/\s+/g,"\\s+"));if(d=r(d,c))return d;if(b=/^function on([\w$]+)\s*\(event\)\s*\{\s*(\S[\s\S]*\S)\s*\}\s*$/.exec(a)){a=
b[1];b=k(b[2]);d=RegExp("on"+a+"=[\\'\"]\\s*"+b+"\\s*[\\'\"]","i");if(d=r(d,c[0]))return d;d=RegExp(b);if(d=r(d,c))return d}return null}function v(a,b,c,d,e){b={url:b,line:c,column:e};if(b.url&&b.line){a.incomplete=!1;b.func||(b.func=f(b.url,b.line));b.context||(b.context=i(b.url,b.line));if(e=/ '([^']+)' /.exec(e))b.column=n(e[1],b.url,b.line);if(0<a.stack.length&&a.stack[0].url===b.url){if(a.stack[0].line===b.line)return!1;if(!a.stack[0].line&&a.stack[0].func===b.func)return a.stack[0].line=b.line,
a.stack[0].context=b.context,!1}a.stack.unshift(b);return a.partial=!0}a.incomplete=!0;return!1}function A(a,b){for(var d=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,e=[],i={},k,h,g=arguments.callee.caller;g;g=g.caller)if(!(g===c||g===TraceKit.report)){h={url:null,func:"?",line:null,column:null};if(g.name)h.func=g.name;else if(k=d.exec(g.toString()))h.func=k[1];if(k=m(g)){h.url=k.url;h.line=k.line;"?"===h.func&&(h.func=f(h.url,h.line));var r=/ '([^']+)' /.exec(a.message||
a.description);r&&(h.column=n(r[1],k.url,k.line))}i[""+g]&&(h.recursion=!0);e.push(h)}b&&e.splice(0,b);d={mode:"callers",name:a.name,message:a.message,stack:e};v(d,a.sourceURL||a.fileName,a.line||a.lineNumber,a.message||a.description);return d}function c(a,c){var d=null,c=void 0===c?0:+c;try{for(var e=/ line (\d+), column (\d+) in (?:<anonymous function: ([^>]+)>|([^\)]+))\((.*)\) in (.*):\s*$/i,m=a.stacktrace.split("\n"),p=[],h,v=0,L=m.length;v<L;v+=2)if(h=e.exec(m[v])){var u={line:+h[1],column:+h[2],
func:h[3]||h[4],args:h[5]?h[5].split(","):[],url:h[6]};!u.func&&u.line&&(u.func=f(u.url,u.line));if(u.line)try{u.context=i(u.url,u.line)}catch(U){}u.context||(u.context=[m[v+1]]);p.push(u)}d=p.length?{mode:"stacktrace",name:a.name,message:a.message,stack:p}:null;if(d)return d}catch(M){if(b)throw M;}try{if(a.stack){var e=/^\s*at (?:new )?(.+) (?:\[as \S+\] )?\(((?:file|https?):.*?):(\d+)(?::(\d+))?\)\s*$/i,m=/^\s*(\S*)(?:\((.*?)\))?@((?:file|http).*?):(\d+)(?::(\d+))?\s*$/i,C=a.stack.split("\n"),p=
[],q,s,B=/^(.*) is undefined$/.exec(a.message);h=0;for(var E=C.length;h<E;++h){if(q=m.exec(C[h]))s={url:q[3],func:q[1],args:q[2]?q[2].split(","):"",line:+q[4],column:q[5]?+q[5]:null};else if(q=e.exec(C[h]))s={url:q[2],func:q[1],line:+q[3],column:q[4]?+q[4]:null};else continue;!s.func&&s.line&&(s.func=f(s.url,s.line));s.line&&(s.context=i(s.url,s.line));p.push(s)}p[0]&&(p[0].line&&!p[0].column&&B)&&(p[0].column=n(B[1],p[0].url,p[0].line));d=p.length?{mode:"stack",name:a.name,message:a.message,stack:p}:
null}else d=null;if(d)return d}catch(N){if(b)throw N;}try{var y=a.message.split("\n");if(4>y.length)d=null;else{C=/^\s*Line (\d+) of linked script ((?:file|http)\S+)(?:: in function (\S+))?\s*$/i;q=/^\s*Line (\d+) of inline#(\d+) script in ((?:file|http)\S+)(?:: in function (\S+))?\s*$/i;s=/^\s*Line (\d+) of function script\s*$/i;var B=[],l=document.getElementsByTagName("script"),E=[],w,t,H,z;for(t in l)l.hasOwnProperty(t)&&!l[t].src&&E.push(l[t]);t=2;for(H=y.length;t<H;t+=2){l=null;if(w=C.exec(y[t]))l=
{url:w[2],func:w[3],line:+w[1]};else if(w=q.exec(y[t])){var l={url:w[3],func:w[4]},O=+w[1],I=E[w[2]-1];if(I&&(z=g(l.url))){z=z.join("\n");var J=z.indexOf(I.innerText);0<=J&&(l.line=O+z.substring(0,J).split("\n").length)}}else if(w=s.exec(y[t])){var K=window.location.href.replace(/#.*$/,""),P=w[1],Q=RegExp(k(y[t+1]));z=r(Q,[K]);l={url:K,line:z?z.line:P,func:""}}if(l){l.func||(l.func=f(l.url,l.line));var D=i(l.url,l.line),R=D?D[Math.floor(D.length/2)]:null;l.context=D&&R.replace(/^\s*/,"")===y[t+1].replace(/^\s*/,
"")?D:[y[t+1]];B.push(l)}}d=B.length?{mode:"multiline",name:a.name,message:y[0],stack:B}:null}if(d)return d}catch(S){if(b)throw S;}try{if(d=A(a,c+1))return d}catch(T){if(b)throw T;}return{mode:"failed"}}var b=!1,d={};c.augmentStackTraceWithInitialElement=v;c.guessFunctionName=f;c.gatherContext=i;c.ofCaller=function(a){a=(void 0===a?0:+a)+1;try{0()}catch(b){return c(b,a+1)}return null};return c}();
(function(g){var f=Array.prototype.slice,i=g.setTimeout;g.setTimeout=function(){var e=f.call(arguments,0),g=e[0];e[0]=function(){try{g.apply(this,arguments)}catch(e){throw TraceKit.report(e),e;}};return i.apply(this,e)};var e=g.setInterval;g.setInterval=function(){var g=f.call(arguments,0),i=g[0];g[0]=function(){try{i.apply(this,arguments)}catch(e){throw TraceKit.report(e),e;}};return e.apply(this,g)}})(window);
